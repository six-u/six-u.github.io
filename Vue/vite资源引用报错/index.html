<!DOCTYPE html><html lang="en" manifest="/sixu.appcache"><head><meta charset="utf-8"><meta name="keywords" content="web, 前端, JS, Vue"><meta name="description" content="技术没有边界，人也没有"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>vite资源引用报错 | SixU 煦之</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/pace.min.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><main class="content"><section class="outer"><article id="post-Vue/vite资源引用报错" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">vite资源引用报错</h1></header><div class="article-meta"><a href="/Vue/vite%E8%B5%84%E6%BA%90%E5%BC%95%E7%94%A8%E6%8A%A5%E9%94%99/" class="article-date"><time datetime="2021-01-13T15:18:06.000Z" itemprop="datePublished">2021-01-13</time></a><div class="article-category"><a class="article-category-link" href="/categories/Vue/">Vue</a></div></div><div class="tocbot"></div><div class="article-entry" itemprop="articleBody"><h2 id="vite-构建-vue3-项目，资源引用报错"><a href="#vite-构建-vue3-项目，资源引用报错" class="headerlink" title="vite 构建 vue3 项目，资源引用报错"></a>vite 构建 vue3 项目，资源引用报错</h2><p>使用 vite 创建 vue3 项目，开发环境一直没问题，打包时就报找不到资源路径的错误，翻阅文档方知，引用资源时，vite.config.js 中配置的路径别名并不好用。</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><h3 id="方法-1："><a href="#方法-1：" class="headerlink" title="方法 1："></a>方法 1：</h3><ol><li><p>将 <strong>/src/assets</strong> 目录的内容移动到 <strong>/public/assets</strong></p></li><li><p>将 templete 中引用资源改写为：</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;img</span><br><span class="line">  :src&#x3D;&quot;</span><br><span class="line">    &#39;.&#x2F;assets&#x2F;img&#x2F;cities&#x2F;&#39; +</span><br><span class="line">    build.type +</span><br><span class="line">    &#39;_&#39; +</span><br><span class="line">    build.faction +</span><br><span class="line">    &#39;_&#39; +</span><br><span class="line">    build.level +</span><br><span class="line">    &#39;.png&#39;</span><br><span class="line">  &quot;</span><br><span class="line">  class&#x3D;&quot;build-img&quot;</span><br><span class="line">&#x2F;&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>将 css 中引用资源改写为：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">background</span>: <span class="selector-tag">url</span>(&quot;/<span class="selector-tag">assets</span>/<span class="selector-tag">img</span>/<span class="selector-tag">our_selector</span><span class="selector-class">.png</span>&quot;) <span class="selector-tag">no-repeat</span>;</span><br></pre></td></tr></table></figure><h3 id="方法-2："><a href="#方法-2：" class="headerlink" title="方法 2："></a>方法 2：</h3><ol><li><p>在 script 中使用 import imgUrl from ‘ /assets/img/our_selector.png ‘ ，获取资源路径</p></li><li><p>将 imgUrl 变量赋值给需要引用的地方</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    imgUrl</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="问题情况："><a href="#问题情况：" class="headerlink" title="问题情况："></a>问题情况：</h2><p>资源在 src 下的 assets 文件夹，在 template 和 style 中使用路径别名引入，开发时没毛病，build 后就找不到资源了。</p><p>在 vite 中设置路径别名如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">alias: &#123;</span><br><span class="line"></span><br><span class="line">*<span class="comment">// 键必须以斜线开始和结束*</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;/@/&quot;</span>: path.resolve(__dirname, <span class="string">&quot;./src/&quot;</span>),</span><br><span class="line"></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>此时资源地址为 /src/assets/….. 项目中需要用到资源的地方如下，及 template 与 css 中引入资源：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;img</span><br><span class="line">  :src&#x3D;&quot;</span><br><span class="line">    &#39;&#x2F;@&#x2F;assets&#x2F;img&#x2F;cities&#x2F;&#39; +</span><br><span class="line">    build.type +</span><br><span class="line">    &#39;_&#39; +</span><br><span class="line">    build.faction +</span><br><span class="line">    &#39;_&#39; +</span><br><span class="line">    build.level +</span><br><span class="line">    &#39;.png&#39;</span><br><span class="line">  &quot;</span><br><span class="line">  class&#x3D;&quot;build-img&quot;</span><br><span class="line">&#x2F;&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">background</span>: <span class="selector-tag">url</span>(&quot;/@/assets/img/our_selector.png&quot;) no-repeat;</span><br></pre></td></tr></table></figure><h3 id="build-时报错：（找不到-css-url-中的资源）"><a href="#build-时报错：（找不到-css-url-中的资源）" class="headerlink" title="build 时报错：（找不到 css url()中的资源）"></a>build 时报错：（找不到 css url()中的资源）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: ENOENT: no such file or directory, open &#x27;C:\Users\wwwangl\Desktop\land-grabber-web\@\assets\img\our_selector.png&#x27;</span><br></pre></td></tr></table></figure><h3 id="build-后报错：（找不到-template-中-img-src-应用的资源）"><a href="#build-后报错：（找不到-template-中-img-src-应用的资源）" class="headerlink" title="build 后报错：（找不到 template 中 img src 应用的资源）"></a>build 后报错：（找不到 template 中 img src 应用的资源）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://10.64.94.40:5500/@/assets/img/cities/Town_green_1.png 404 (Not Found)</span><br></pre></td></tr></table></figure><h2 id="文档出处："><a href="#文档出处：" class="headerlink" title="文档出处："></a>文档出处：</h2><p><a target="_blank" rel="noopener" href="https://vitejs.dev/guide/features.html#css-pre-processors">https://vitejs.dev/guide/features.html#css-pre-processors</a></p><h3 id="原文："><a href="#原文：" class="headerlink" title="原文："></a>原文：</h3><blockquote><h3 id="URL-Imports"><a href="#URL-Imports" class="headerlink" title="URL Imports"></a>URL Imports</h3><p>Importing a static asset will return the resolved public URL when it is served:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import imgUrl from &#39;.&#x2F;img.png&#39;</span><br><span class="line">document.getElementById(&#39;hero-img&#39;).src &#x3D; imgUrl</span><br></pre></td></tr></table></figure><p>The behavior is similar to webpack’s <code>file-loader</code>. The difference is that the import can be either using absolute<br>public paths (based on project root during dev) or relative paths.</p><ul><li><code>url()</code> references in CSS are handled the same way.</li><li>If using the Vue plugin, asset references in Vue SFC templates are automatically converted into imports.</li><li>Common image, media, and font filetypes are detected as assets automatically. You can extend the internal list using<br>the <a target="_blank" rel="noopener" href="https://vitejs.dev/config/#assetsinclude"><code>assetsInclude</code> option</a>.</li><li>Referenced assets are included as part of the build assets graph, will get hashed file names, and can be processed<br>by plugins for optimization.</li><li>Assets smaller in bytes than the <a target="_blank" rel="noopener" href="https://vitejs.dev/config/#assetsinlinelimit"><code>assetsInlineLimit</code> option</a> will be<br>inlined as base64 data URLs.</li></ul><h3 id="The-public-Directory"><a href="#The-public-Directory" class="headerlink" title="#The public Directory"></a><a target="_blank" rel="noopener" href="https://vitejs.dev/guide/features.html#the-public-directory">#</a>The <code>public</code> Directory</h3><p>If you have assets that are:</p><ul><li>Never referenced in source code (e.g. <code>robots.txt</code>)</li><li>Must retain the exact same file name (without hashing)</li><li>…or you simply don’t want to have to import an asset first just to get its URL</li></ul><p>Then you can place the asset in a special <code>public</code> directory under your project root. Assets in this directory will be<br>served at root path <code>/</code> during dev, and copied to the root of the dist directory as-is.</p><p>Note that:</p><ul><li>You should always reference <code>public</code> assets using root absolute path - for example, <code>public/icon.png</code> should be<br>referenced in source code as <code>/icon.png</code>.</li><li>Assets in <code>public</code> cannot be imported from JavaScript.</li></ul></blockquote></div><footer class="article-footer"><a data-url="http://six-u.github.io/Vue/vite%E8%B5%84%E6%BA%90%E5%BC%95%E7%94%A8%E6%8A%A5%E9%94%99/" data-id="cks7lkrri001apofe28sf3mh9" class="article-share-link">分享</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/" rel="tag">@</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/vite/" rel="tag">vite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/vue/" rel="tag">vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/vue3/" rel="tag">vue3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/%E8%B5%84%E6%BA%90%E5%BC%95%E7%94%A8/" rel="tag">资源引用</a></li></ul></footer></div><div class="vcomments" id="vcomments"></div><script src="https://unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"geSruNdqLwsDxJSjaAmTiSQR-gzGzoHsz",appKey:"LmoURXO6RVhvCmEe2TBxdo8I",notify:"false",verify:"true",avatar:"mp",pageSize:"10",placeholder:"请输入..."})</script></article></section><footer class="footer" id="footer"><div class="outer"><div class="float-right"><ul class="list-inline"><li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li><li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li></ul></div><ul class="list-inline"><li>SixU 煦之 &copy; 2021</li></ul></div></footer></main><aside class="sidebar"><button class="navbar-toggle"></button><nav class="navbar"><div class="logo"><a href="/"><img src="/images/logo-s.png" alt="SixU  煦之"></a></div><ul class="nav nav-main"><li class="nav-item"><a class="nav-item-link" href="/index">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-item-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-item-link" href="/tags/">标签</a></li><li class="nav-item"><a class="nav-item-link" href="/muxia/">木下</a></li><li class="nav-item"><a class="nav-item-link" href="/about/">关于</a></li><li class="nav-item terminal"><a class="nav-item-link" href="/simpleConsole.html"><i class="fe fe-terminal"></i> Ter</a></li><li class="nav-item"><a class="nav-item-link" href="https://github.com/six-u" target="_blank"><i class="fe fe-github"></i> Github</a></li><li class="nav-item"><a class="nav-item-link nav-item-search" title="搜索"><i class="fe fe-search"></i> 搜索</a></li><li class="nav-item"><a target="_blank" rel="noopener" href="https://sixu-test.myshopify.com/" title="搜索"><i class="fe fe-search"></i> ddd</a></li></ul></nav><nav class="navbar navbar-bottom"><ul class="nav"><li class="nav-item"><div class="totop" id="totop"><i class="fe fe-rocket"></i></div></li></ul></nav><div class="search-form-wrap"><div class="local-search local-search-plugin"><input type="search" id="local-search-input" class="local-search-input" placeholder="Search..."><div id="local-search-result" class="local-search-result"></div></div></div></aside><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/busuanzi-2.3.pure.min.js"></script><script src="/js/tocbot.min.js"></script><script>tocbot.init({tocSelector:".tocbot",contentSelector:".article-entry",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0,scrollSmooth:!0,positionFixedSelector:".tocbot",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"})</script><script src="/js/ocean.js"></script></body></html>