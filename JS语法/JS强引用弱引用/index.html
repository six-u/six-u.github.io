<!DOCTYPE html><html lang="en" manifest="/sixu.appcache"><head><meta charset="utf-8"><meta name="keywords" content="web, 前端, JS, Vue"><meta name="description" content="技术没有边界，人也没有"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>JS强引用弱引用 | SixU 煦之</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/pace.min.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body><main class="content"><section class="outer"><article id="post-JS语法/JS强引用弱引用" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">JS强引用弱引用</h1></header><div class="article-meta"><a href="/JS%E8%AF%AD%E6%B3%95/JS%E5%BC%BA%E5%BC%95%E7%94%A8%E5%BC%B1%E5%BC%95%E7%94%A8/" class="article-date"><time datetime="2021-05-19T15:17:36.000Z" itemprop="datePublished">2021-05-19</time></a><div class="article-category"><a class="article-category-link" href="/categories/JS%E8%AF%AD%E6%B3%95/">JS语法</a></div></div><div class="tocbot"></div><div class="article-entry" itemprop="articleBody"><h2 id="什么是强引用？"><a href="#什么是强引用？" class="headerlink" title="什么是强引用？"></a><strong>什么是强引用？</strong></h2><p>所谓强引用 (Strong Reference) 就是我们<strong>常见的普通对象引用</strong>，只要还有强引用指向一个对象，就能表明对象还活着。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> student = &#123;<span class="comment">/*some properties*/</span>&#125;</span><br><span class="line"><span class="keyword">let</span> employee = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> boss = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure><p>以上student 、employee 、boss 等变量对对象的引用，均为<strong>强引用</strong></p><p><strong>特点：强引用的对象在js中不会被<a target="_blank" rel="noopener" href="https://six-u.gitee.io/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">垃圾回收</a></strong></p><h2 id="什么是弱引用？"><a href="#什么是弱引用？" class="headerlink" title="什么是弱引用？"></a><strong>什么是弱引用？</strong></h2><p>网上有个例子：</p><blockquote><p>强引用就是一个小孩A牵着一条狗，他们之间通过狗链儿连着</p><p>弱引用就是，旁边有个小孩B指着A牵的狗，说：嘿，那有条狗，B指向那条狗，但他们之间没有是指绑在一起的东西</p><p>当A放开狗链，狗就会跑掉（被垃圾回收），无论B是不是还指着</p><p>但是，当B不再指着那条狗，狗还被A牵着，不会影响它是否跑掉</p></blockquote><p>也即是说，如果在使用引用计数方式的垃圾回收策略的浏览器中，可以看作当产生一个弱引用时，计数并不会加1。</p><h2 id="js中弱引用的例子"><a href="#js中弱引用的例子" class="headerlink" title="js中弱引用的例子"></a><strong>js中弱引用的例子</strong></h2><p>在JS中，ES6新增的 <a target="_blank" rel="noopener" href="https://six-u.gitee.io/JS%E8%AF%AD%E6%B3%95/Set,WeakSet,Map,WeakMap/">WeakMap 和 WeakSet</a> 给我们提供了部分弱引用的能力，其中WeakMap接受引用类型的 key，WeakSet接受只接受引用类型的值，以下时MDN的描述：</p><p>WeakSet 对象允许你将弱保持对象存储在一个集合中。</p><p>WeakMap 对象是一组键/值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。</p><p><strong>当然真正实现弱引用的API 其实是 WeakRef对象</strong></p><p>​ WeakRef对象包含对对象的弱引用，这个弱引用被称为该WeakRef对象的target或者是referent。对对象的弱引用是指当该对象应该被GC回收时不会阻止GC的回收行为。而与此相反的，一个普通的引用（默认是强引用）会将与之对应的对象保存在内存中。只有当该对象没有任何的强引用时，JavaScript引擎GC才会销毁该对象并且回收该对象所占的内存空间。如果上述情况发生了，那么你就无法通过任何的弱引用来获取该对象。</p><p><strong>参考</strong></p><blockquote><p><a target="_blank" rel="noopener" href="https://v8.dev/features/weak-references">Weak references and finalizers · V8</a></p><p><a target="_blank" rel="noopener" href="https://www.infoq.cn/article/lKsmb2tlGH1EHG0*bbYg">如何实现JS真正意义上的弱引用？-InfoQ</a></p><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakRef">WeakRef - JavaScript | MDN (mozilla.org)</a></p></blockquote></div><footer class="article-footer"><a data-url="http://six-u.github.io/JS%E8%AF%AD%E6%B3%95/JS%E5%BC%BA%E5%BC%95%E7%94%A8%E5%BC%B1%E5%BC%95%E7%94%A8/" data-id="cks7lkrq30009pofe0k349qbd" class="article-share-link">分享</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/WeakMap/" rel="tag">WeakMap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/WeakSet/" rel="tag">WeakSet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" rel="tag">垃圾回收</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/%E5%BC%B1%E5%BC%95%E7%94%A8/" rel="tag">弱引用</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag-list/%E5%BC%BA%E5%BC%95%E7%94%A8/" rel="tag">强引用</a></li></ul></footer></div><div class="vcomments" id="vcomments"></div><script src="https://unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"geSruNdqLwsDxJSjaAmTiSQR-gzGzoHsz",appKey:"LmoURXO6RVhvCmEe2TBxdo8I",notify:"false",verify:"true",avatar:"mp",pageSize:"10",placeholder:"请输入..."})</script></article></section><footer class="footer" id="footer"><div class="outer"><div class="float-right"><ul class="list-inline"><li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li><li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li></ul></div><ul class="list-inline"><li>SixU 煦之 &copy; 2021</li></ul></div></footer></main><aside class="sidebar"><button class="navbar-toggle"></button><nav class="navbar"><div class="logo"><a href="/"><img src="/images/logo-s.png" alt="SixU  煦之"></a></div><ul class="nav nav-main"><li class="nav-item"><a class="nav-item-link" href="/index">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-item-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-item-link" href="/tags/">标签</a></li><li class="nav-item"><a class="nav-item-link" href="/muxia/">木下</a></li><li class="nav-item"><a class="nav-item-link" href="/about/">关于</a></li><li class="nav-item terminal"><a class="nav-item-link" href="/simpleConsole.html"><i class="fe fe-terminal"></i> Ter</a></li><li class="nav-item"><a class="nav-item-link" href="https://github.com/six-u" target="_blank"><i class="fe fe-github"></i> Github</a></li><li class="nav-item"><a class="nav-item-link nav-item-search" title="搜索"><i class="fe fe-search"></i> 搜索</a></li><li class="nav-item"><a target="_blank" rel="noopener" href="https://sixu-test.myshopify.com/" title="搜索"><i class="fe fe-search"></i> ddd</a></li></ul></nav><nav class="navbar navbar-bottom"><ul class="nav"><li class="nav-item"><div class="totop" id="totop"><i class="fe fe-rocket"></i></div></li></ul></nav><div class="search-form-wrap"><div class="local-search local-search-plugin"><input type="search" id="local-search-input" class="local-search-input" placeholder="Search..."><div id="local-search-result" class="local-search-result"></div></div></div></aside><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/busuanzi-2.3.pure.min.js"></script><script src="/js/tocbot.min.js"></script><script>tocbot.init({tocSelector:".tocbot",contentSelector:".article-entry",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0,scrollSmooth:!0,positionFixedSelector:".tocbot",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"})</script><script src="/js/ocean.js"></script></body></html>